# コーディング規約

Git Karmaプロジェクト全体でコードの品質と一貫性を維持するために、以下のコーディング規約に従ってください。

## 1. 一般原則

- **TypeScript First**: 新しいコードはすべてTypeScriptで記述する必要があります。`any`型の使用は避け、明示的な型またはジェネリクスを使用してください。
- **関数コンポーネント**: Hooksを使用したReact関数コンポーネントを使用してください。クラスコンポーネントは推奨されません。
- **デフォルトでサーバーコンポーネント**: Next.js App Routerでは、コンポーネントはデフォルトでサーバーコンポーネントです。インタラクティビティ（状態、副作用、イベントリスナー）が必要な場合にのみ、`"use client"`を追加してください。

## 2. 命名規則

- **ファイルとディレクトリ**:
  - コンポーネント: `PascalCase.tsx` (例: `UserProfile.tsx`)
  - ユーティリティ/Hooks: `camelCase.ts` (例: `useAuth.ts`, `formatDate.ts`)
  - 定数: `UPPER_SNAKE_CASE`
- **変数と関数**: `camelCase`
- **コンポーネント**: `PascalCase`
- **インターフェース/型**: `PascalCase` (インターフェースに `I` プレフィックスは付けない)

## 3. ディレクトリ構造とコロケーション

- **コロケーション**: 関連するファイルは近くに配置します。コンポーネントがある機能でのみ使用される場合は、その機能のディレクトリ内に配置します。
- **共有コンポーネント**: 再利用可能なUIコンポーネントは `src/components/ui` または `src/components/common` に配置します。
- **機能**: 機能固有のロジックは `src/features/` または `src/components/<feature>` に配置します。

## 4. スタイリング (Tailwind CSS)

- **ユーティリティファースト**: スタイリングにはTailwind CSSのユーティリティクラスを使用します。
- **恣意的な値の回避**: どうしても必要な場合を除き、`w-[123px]` のような記述は避けてください。テーマの値（例: `w-32`）を使用します。
- **クラスの並び順**: 理想的には、一貫した順序（例: レイアウト -> スペーシング -> タイポグラフィ -> 装飾）に従ってください。

## 5. 状態管理

- **サーバー状態**: サーバー（サーバーコンポーネント）でデータを取得し、それを渡すことを優先します。
- **クライアント状態**: ローカルなUI状態には `useState` と `useReducer` を使用します。
- **グローバル状態**: グローバル状態は最小限に抑えます。広くアクセス可能なデータ（テーマや認証など）が必要な場合にのみContext APIを使用します。

## 6. データベースとAPI

- **Prisma**: `@/lib/prisma` からのグローバルなPrismaクライアントインスタンスを使用します。
- **Server Actions**: 適切な場合、APIルートよりもServer Actionsを優先してミューテーションを行います。
- **バリデーション**: クライアント（フォーム）とサーバー（API入力）の両方でスキーマバリデーションに **Zod** を使用します。

## 7. テスト

- **単体テスト**: ユーティリティ関数や複雑なロジックに対して、Vitestを使用して単体テストを記述します。
- **コンポーネントテスト**: 重要なUIコンポーネントをテストします。

## 8. Gitとコミット

- **Conventional Commits**: [Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/) 仕様に従ってください。
  - `feat`: 新機能
  - `fix`: バグ修正
  - `docs`: ドキュメントのみの変更
  - `style`: フォーマット、セミコロンの欠落など
  - `refactor`: バグ修正も機能追加も行わないコードの変更
  - `test`: テストの追加
  - `chore`: メンテナンス作業
